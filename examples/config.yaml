---
version: v1alpha1
debug: false

redis:
  endpoint: 127.0.0.1:6379

database:
  dsn: "postgresql://inventory:p4ssw0rd@localhost:5432/inventory?sslmode=disable"
  migration_dir: ./internal/pkg/migrations

worker:
  concurrency: 100

scheduler:
  jobs:
    # AWS
    - name: "aws:task:collect-regions"
      spec: "@every 720h"  # 30 days
      desc: "Collect AWS Regions"
    - name: "aws:task:collect-azs"
      spec: "@every 720h"  # 30 days
      desc: "Collect AWS AZs"
    - name: "aws:task:collect-vpcs"
      spec: "@every 1h"
      desc: "Collect AWS VPCs"
    - name: "aws:task:collect-subnets"
      spec: "@every 1h"
      desc: "Collect AWS Subnets"
    - name: "aws:task:collect-instances"
      spec: "@every 1h"
      desc: "Collect AWS EC2 Instances"
    - name: "aws:task:link-all"
      spec: "@every 30m"
      desc: "Link all AWS models"

    # Gardener
    - name: "g:task:collect-projects"
      spec: "@every 1h"
      desc: "Collect Gardener Projects"
    - name: "g:task:collect-seeds"
      spec: "@every 1h"
      desc: "Collect Gardener Seeds"
    - name: "g:task:collect-shoots"
      spec: "@every 1h"
      desc: "Collect Gardener Shoots"
    - name: "g:task:collect-machines"
      spec: "@every 1h"
      desc: "Collect Gardener Machines"
    - name: "g:task:link-all"
      spec: "@every 30m"
      desc: "Link all Gardener models"

    # The housekeeper takes care of cleaning up stale records
    - name: "common:task:housekeeper"
      spec: "@every 12h"
      payload: >-
        retention:
          # AWS
          - name: "aws:model:region"
            duration: 1080h  # 45 days
          - name: "aws:model:az"
            duration: 1080h  # 45 days
          - name: "aws:model:vpc"
            duration: 24h
          - name: "aws:model:subnet"
            duration: 24h
          - name: "aws:model:instance"
            duration: 24h
          # Gardener
          - name: "g:model:project"
            duration: 24h
          - name: "g:model:seed"
            duration: 168h  # 7 days
          - name: "g:model:shoot"
            duration: 24h
          - name: "g:model:machine"
            duration: 24h

virtual_garden:
  # Path to Virtual Garden kubeconfig
  kubeconfig:
  # Environment type (dev, staging, canary, live)
  environment: dev
